<!DOCTYPE html>
<html>
<head>
  <title>Vaani AI Support</title>
  <style>

    body {
      margin:0;
      font-family: Arial, sans-serif;
      background:#0f172a;
      color:white;
      display:flex;
      justify-content:center;
      align-items:center;
      height:100vh;
    }

    .container {
      background:#1e293b;
      width:350px;
      padding:30px;
      border-radius:20px;
      box-shadow:0 0 30px rgba(0,0,0,0.5);
      text-align:center;
    }

    h2 {
      margin-bottom:20px;
    }

    .status {
      margin:20px 0;
      font-size:14px;
      opacity:0.7;
    }

    .voice-circle {
      width:120px;
      height:120px;
      border-radius:50%;
      background:#22c55e;
      margin:20px auto;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:40px;
      transition:0.3s;
    }

    .listening {
      background:#ef4444;
      transform:scale(1.1);
    }

    .thinking {
      background:#f59e0b;
    }

    button {
      padding:12px 20px;
      border:none;
      border-radius:10px;
      background:#3b82f6;
      color:white;
      font-size:16px;
      cursor:pointer;
      margin-top:20px;
    }

    .log {
      margin-top:20px;
      font-size:14px;
      text-align:left;
      background:#020617;
      padding:10px;
      border-radius:10px;
      height:120px;
      overflow:auto;
    }

  </style>
</head>

<body>

<div class="container">

  <h2>AI Voice Support</h2>

  <div id="circle" class="voice-circle">ðŸŽ¤</div>

  <div id="status" class="status">Ready</div>

  <button onclick="startListening()">Start Conversation</button>

  <div id="log" class="log"></div>

</div>

<script>

const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
recognition.lang = "hi-IN";

const circle = document.getElementById("circle");
const status = document.getElementById("status");
const log = document.getElementById("log");

function startListening() {
  circle.classList.add("listening");
  status.innerText = "Listening...";
  recognition.start();
}

recognition.onresult = function(event) {
  const userSpeech = event.results[0][0].transcript;

  log.innerHTML += "<p><b>You:</b> " + userSpeech + "</p>";

  circle.classList.remove("listening");
  circle.classList.add("thinking");
  status.innerText = "Processing...";

  respond(userSpeech);
}

async function respond(message) {

  circle.classList.remove("listening");
  circle.classList.add("thinking");
  status.innerText = "Understanding...";

  const API_KEY = "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";

  const systemPrompt = `
  You are a human-like customer support voice agent.
  Reply naturally in Hindi, English or Hinglish.
  Be polite and realistic like real support staff.
  Keep responses short and helpful.
  `;

  const response = await fetch("https://api.openai.com/v1/chat/completions", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer " + API_KEY
    },
    body: JSON.stringify({
      model: "gpt-4o-mini",
      messages: [
        { role: "system", content: systemPrompt },
        { role: "user", content: message }
      ]
    })
  });

  const data = await response.json();
  const reply = data.choices[0].message.content;

  speak(reply);
}

function speak(text) {

  log.innerHTML += "<p><b>AI:</b> " + text + "</p>";

  const speech = new SpeechSynthesisUtterance(text);
  speech.lang = "en-IN";

  window.speechSynthesis.speak(speech);

  circle.classList.remove("thinking");
  status.innerText = "Ready";
}

</script>

</body>
</html>
